import { Meta, Story } from '@storybook/addon-docs';

import {moduleMetadata} from "@storybook/angular";
import {BrowserModule} from "@angular/platform-browser";
import {CommonModule} from "@angular/common";
import {GenericTableCoreModule} from "../../../core/src/lib/core.module";
import {Simple, SimpleComponent} from "../app/examples/simple/simple.component";
import {Mobile, MobileLayoutComponent} from "../app/examples/mobile-layout/mobile-layout.component";
import {Advanced, AdvancedComponent} from "../app/examples/advanced/advanced.component";
import {ReactiveFormsModule} from "@angular/forms";
import {TabsComponent} from "../app/components/tabs/tabs.component";
import {CustomTemplates, CustomTemplatesComponent} from "../app/examples/custom-templates/custom-templates.component";
import {Pagination, PaginationComponent} from "../app/examples/pagination/pagination.component";
import {HttpClientModule} from "@angular/common/http";
import {GenericTablePaginationModule} from "../../../core/src/lib/pagination/pagination.module";
import {Horizontal, HorizontalTableComponent} from "../app/examples/horizontal-table/horizontal-table.component";
import {Nested, NestedDataComponent} from "../app/examples/nested-data/nested-data.component";
import {Transpose} from '../app/examples/transpose/transpose.component'; import {
  RowHoverClick,
  RowHoverClickComponent
} from '../app/examples/row-hover-click/row-hover-click.component';

<Meta title="Examples" decorators={[
  moduleMetadata({
    declarations: [CustomTemplatesComponent, SimpleComponent, AdvancedComponent, PaginationComponent, HorizontalTableComponent, TabsComponent, MobileLayoutComponent, NestedDataComponent, RowHoverClickComponent],
    imports: [BrowserModule, CommonModule, GenericTableCoreModule, GenericTablePaginationModule, ReactiveFormsModule, HttpClientModule],
  })]}/>

# Examples


## Basic table

Pass `data` and `config` to table to generate a table. The example below uses the minimal configuration needed to generate a table with static data.

<Story name="Basic table"
       args={{
         data: [
           {
             firstName: 'Mark',
             lastName: 'Parker',
             gender: 'male',
             favoriteFood: 'Pasta',
           },
           {
             firstName: 'Mary Jane',
             lastName: 'Watson',
             gender: 'female',
             favoriteFood: 'Pizza',
           },
         ]
       }}>
  {Simple.bind({})}
</Story>


## Nested data table

Generic table can generate tables based on nested JSON structures, just use `mapTo` option and pass string path to object value as `path` and optionally a `missingValue` value which will be used if key is undefined.

<Story name="Nested data"
       args={{
         data: [
           {
             name: {
               first: 'Peter',
               last: 'Parker',
             },
             data: {
               details: {
                 gender: 'male',
                 favoriteFood: 'Pasta',
               }
             },
           },
           {
             name: {
               first: 'Mary Jane',
               last: 'Watson',
             },
             data: {
               details: {
                 gender: 'female',
                 favoriteFood: 'Pizza',
               }
             }
           },
         ]
       }}>
  {Nested.bind({})}
</Story>


## Custom templates

Define custom templates and assign them to different columns using the `templateRef` property when declaring `columns` in `config`.

<Story name="Custom templates"
       args={{
         data: [
           {
             firstName: 'Peter',
             lastName: 'Parker',
             gender: 'male',
             favoriteColor: '#26BFAF',
             favoriteFood: 'Pasta',
           },
           {
             firstName: 'Mary Jane',
             lastName: 'Watson',
             gender: 'female',
             favoriteColor: '#0f0',
             favoriteFood: 'Pizza',
           },
         ]
       }}>
  {CustomTemplates.bind({})}
</Story>


## Advanced example

Example showcasing:
* Row sort
* Loading state
* Empty state
* Global search
* Mobile table layout with sticky header (resize viewport to < 576px to view example)
* Custom pagination
* Add/remove data
* Custom templates

<Story name="Advanced"
       args={{
         data: [
           {
             firstName: 'Peter',
             lastName: 'Parker',
             gender: 'male',
             favoriteColor: '#26BFAF',
             favoriteFood: 'Pasta',
           },
           {
             firstName: 'Mary Jane',
             lastName: 'Watson',
             gender: 'female',
             favoriteColor: '#0f0',
             favoriteFood: 'Pizza',
           },
         ]
       }}>
  {Advanced.bind({})}
</Story>


## Pagination example

What would a table be without pagination? To simplify things for you, Angular Generic Table provides a basic pagination component. Just pass a reference to the table like this:
```markup
<angular-generic-table #tableRef" .../>
<angular-generic-table-pagination [table]="tableRef"/>
```


<Preview>
  <div class="overflow-auto">
  <table>
    <thead>
    <tr>
      <th>@Input</th>
      <th>Description</th>
      <th>Type</th>
      <th>Default</th>
    </tr>
    </thead>
    <tbody>
    <tr>
      <td><code>table</code></td>
      <td>Table connected to the pagination control.</td>
      <td>Table component</td>
      <td><code>n/a</code></td>
    </tr>
    <tr>
      <td><code>paginationLength</code></td>
      <td>Number of pagination buttons to show.</td>
      <td><code>number</code></td>
      <td><code>5</code></td>
    </tr>
    <tr>
      <td><code>classes</code></td>
      <td>Classes for pagination elements. Pass an object with key values, where key is element and value is classes to be applied.</td>
      <td><code>GtPaginationClasses</code></td>
      <td><code>&#123;<br/>
        &nbsp;nav: null,<br/>
        &nbsp;ul: 'pagination',<br/>
        &nbsp;li: 'page-item',<br/>
        &nbsp;button: 'page-link'<br/>
        &#125;
      </code></td>
    </tr>
    <tr>
      <td><code>ariaLabels</code></td>
      <td>Aria labels for pagination elements. Pass an object with key values, where key is element and value is aria label to use.</td>
      <td><code>GtPaginationAriaLabels</code></td>
      <td><code>
        &#123;<br/>
        &nbsp;nav: 'Table navigation',<br/>
        &nbsp;button: 'Go to page '<br/>
        &#125;
      </code></td>
    </tr>
    </tbody>
  </table>
  </div>
</Preview>

### Import module
In order to use the pagination component provided by angular generic table, you need to import it.
```ts
import { GenericTableCoreModule, GenericTablePaginationModule } from '@angular-generic-table/core';

@NgModule({
  declarations: [...],
  imports: [
    ...
    GenericTableCoreModule,
    GenericTablePaginationModule
  ],
  exports: [
    GenericTableCoreModule,
    GenericTablePaginationModule
  ]
})
export class SharedModule {}
```

<Story name="Pagination">
  {Pagination.bind({})}
</Story>


## Row click and hover

Set `rowClick` and `rowHover` to `true` in `config` to enable row click and hover events which can be used to trigger actions when rows are clicked or hovered. These events are emitted and declared using `@Output rowClick` and `@Output() rowHover`. It's also possible to set hover state on a row using `rowHover` method on the table component (currently it takes a row index as argument), pass null to remove hover state. The later might come in handy when you want to highlight something in the table based on an external source like a chart etc. Note that you should use css if you're only interested in styling the row on row hover, no need to listen to events or set hover state to do that.

<Story name="Row click/hover">
  {RowHoverClick.bind({})}
</Story>

## Horizontal example

Declare `rows` instead of `columns` to get a horizontal table where records are added as columns instead of rows. The example below freezes the first column by setting `stickyHeaders.row` to true, it also uses `<gt-delta>` which is a helper component to display the delta between two values (by default it compares against previous row or column).

<Story name="Horizontal table">
  {Horizontal.bind({})}
</Story>

### Transpose table (flip layout)

Here's a similar example with <code>search</code> and <code>pagination</code>, that let the user switch from row-layout to column-layout.
<Story name="Transpose table">
  {Transpose.bind({})}
</Story>


## Toggle mobile layout

Use mobile layout for table by setting `mobileLayout` config option to `true` for table (or by adding class `.table-mobile` to table). Using config option is the preferred way as it will not only add the correct styling but also hide mobile headers automatically when option changes. Generic table uses CSS to create an layout optimized for mobiles, i.e the markup stays the same and it's still use table elements for rendering. Resize the window or view the example below on a small screen to checkout the mobile version as well as the ability toggle to desktop layout.

### Set breakpoint for mobile layout
Since Generic table relies solely on CSS and media queries to accomplish the mobile layout, it's just a matter of declaring a breakpoint using `SCSS`. Override the default value of `576px`
(bootstrap breakpoint for small screens), by passing a new value for `$mobile-style-max-width` like this:

```scss
@use '@angular-generic-table/core/scss' as generic-table-styles with (
  $mobile-style-max-width: 375px
);
@include generic-table-styles.styles();
```


<Story name="Toggle mobile layout">
  {Mobile.bind({})}
</Story>
