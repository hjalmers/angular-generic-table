<table class="table" id="agreementList_table" [ngClass]="(tableConfig$ | async).class">
  <thead>
    <tr *ngIf="{
    config:(tableConfig$ | async)!,
    loading: loading$ | async
    } as table">
      <ng-container *ngFor="let column of table.config.columns | keyvalue: columnOrder">
        <th
          *ngIf="!column.value?.hidden"
          ngClass="{{ column.value?.sortable ? 'sort ' : '' }} {{ sortBy$ | async | sortClass: column.key }} {{
            (column.key | dashCase) + '-column'
          }} {{column.value.class}}"
          [class.disabled]="table.loading"
          (click)="table.loading || !column.value.sortable || sort(column.key)"
        >
          <span>{{ column.value?.header || column.key }}</span>
        </th>
      </ng-container>
    </tr>
  </thead>
  <tbody *ngIf="loading$ | async; else tableContent">
    <tr>
      <td class="p-0" [colSpan]="colspan$ | async">
        <ng-content select=".table-loading"></ng-content>
      </td>
    </tr>
  </tbody>
</table>
<ng-template #tableContent>
  <ng-container
    *ngIf="(table$ | async)! as table"
  >
    <tbody id="agreementList_tableContent" *ngIf="table!.data!.length > 0; else noData">
      <tr *ngFor="let row of table!.data![(currentPage$ | async) || 0]; let i = index" [attr.id]="'tableRow_' + i">
        <ng-container *ngFor="let column of table.config?.columns | keyvalue: columnOrder">
          <td *ngIf="!column.value?.hidden" ngClass="{{(column.key | dashCase) + '-column'}} {{column.value.class}}">
            <span *ngIf="column.value.mobileHeader" class="mobile-header">{{ column.value?.mobileHeader === true ? column.value?.header : column.value?.mobileHeader || column.key }}</span>
            <ng-container [ngTemplateOutlet]="(searchBy$ | async) && !table.config.columns[column.key].templateRef ? highlighted:
            table.config.columns[column.key].templateRef ? templateRef :
            rawData" [ngTemplateOutletContext]="{row: row, column: column, search: (searchBy$ | async), templateRef: table.config.columns[column.key].templateRef, index: i}"></ng-container></td>
        </ng-container>
      </tr>
    </tbody>
  </ng-container>
</ng-template>
<ng-template #noData>
  <tbody>
  <tr>
    <td class="p-0" [colSpan]="colspan$ | async">
      <ng-content select=".table-no-data"></ng-content>
    </td>
  </tr>
  </tbody>
</ng-template>
<ng-template #highlighted let-row="row" let-column="column" let-search="search">
  <div [innerHTML]="(row[column.key] | highlight: search)"></div>
</ng-template>
<ng-template #rawData let-row="row" let-column="column">
  {{row[column.key]}}
</ng-template>
<ng-template #templateRef let-row="row" let-column="column" let-index="index" let-templateRef="templateRef">
  <ng-container [ngTemplateOutlet]="templateRef"  [ngTemplateOutletContext]="{row: row, col: column, index: index}"></ng-container>
</ng-template>
